2025-07-10 00:00:39 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 00:00:39 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 00:00:39 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:00:39 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 00:00:40 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 00:01:40 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 9928 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 00:01:40 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 00:01:40 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 00:01:41 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 00:01:41 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 76 ms. Found 9 JPA repository interfaces.
2025-07-10 00:01:41 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 00:01:41 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 00:01:41 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 00:01:42 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 00:01:42 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1746 ms
2025-07-10 00:01:42 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 00:01:42 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 00:01:42 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 00:01:42 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 00:01:42 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 00:01:42 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 00:01:42 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 00:01:43 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: a4180aeb-6f05-4ecd-92e0-904801c99334
2025-07-10 00:01:43 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 00:01:43 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 00:01:43 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 00:01:44 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 00:01:45 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table patient_treatment_plans 
       add constraint FKcbowcevtj6qcbcui5d9gm8h31 
       foreign key (doctor_id) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FKcbowcevtj6qcbcui5d9gm8h31". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table patient_treatment_plans 
       add constraint FKcbowcevtj6qcbcui5d9gm8h31 
       foreign key (doctor_id) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FKcbowcevtj6qcbcui5d9gm8h31". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applyForeignKeys(AbstractSchemaMigrator.java:448)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:269)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FKcbowcevtj6qcbcui5d9gm8h31". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 36 common frames omitted
2025-07-10 00:01:45 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table schedule 
       add constraint FK2xgwttjn6bxcrnserm1g7hg4x 
       foreign key (doctor_id) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2xgwttjn6bxcrnserm1g7hg4x". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table schedule 
       add constraint FK2xgwttjn6bxcrnserm1g7hg4x 
       foreign key (doctor_id) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2xgwttjn6bxcrnserm1g7hg4x". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applyForeignKeys(AbstractSchemaMigrator.java:448)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:269)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2xgwttjn6bxcrnserm1g7hg4x". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 36 common frames omitted
2025-07-10 00:01:45 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table treatment_plan_templates 
       add constraint FK2prxn7dedffni6w7rrv6v8d3y 
       foreign key (created_by) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2prxn7dedffni6w7rrv6v8d3y". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table treatment_plan_templates 
       add constraint FK2prxn7dedffni6w7rrv6v8d3y 
       foreign key (created_by) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2prxn7dedffni6w7rrv6v8d3y". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applyForeignKeys(AbstractSchemaMigrator.java:448)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:269)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2prxn7dedffni6w7rrv6v8d3y". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 36 common frames omitted
2025-07-10 00:01:45 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:01:46 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 00:01:47 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 00:01:47 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 00:01:47 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 00:01:47 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 00:01:47 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 00:01:47 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 00:01:48 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 00:01:48 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 8.433 seconds (process running for 9.264)
2025-07-10 00:02:20 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-10 00:02:20 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-10 00:02:20 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 5 ms
2025-07-10 00:02:21 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/admin/doctors/official
2025-07-10 00:02:21 [http-nio-8080-exec-2] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/admin/doctors/official with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6IkFETUlOIiwiZnVsbE5hbWUiOiJhZG1pbiIsImV4cCI6MTc1MjE2NjIzMH0.jQVcERIaM0bg-F2-lZpq9RKbkzTKgpC4eFptVFmooCo
2025-07-10 00:02:21 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6IkFETUlOIiwiZnVsbE5hbWUiOiJhZG1pbiIsImV4cCI6MTc1MjE2NjIzMH0.jQVcERIaM0bg-F2-lZpq9RKbkzTKgpC4eFptVFmooCo
2025-07-10 00:02:21 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 00:02:21 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 00:02:21 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 00:02:21 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: admin, role: ADMIN
2025-07-10 00:02:21 [http-nio-8080-exec-2] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/admin/doctors/official - username: admin, role: ADMIN
2025-07-10 00:02:21 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: admin with role: ADMIN for request to /api/admin/doctors/official
2025-07-10 00:02:21 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/admin/doctors/official
2025-07-10 00:02:21 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/admin/doctors/official
2025-07-10 00:02:21 [http-nio-8080-exec-2] INFO  c.h.medical.service.UserService - Creating doctor account for email: tramtbse181958@fpt.edu.vn
2025-07-10 00:02:21 [http-nio-8080-exec-2] INFO  c.h.medical.service.UserService - User saved successfully with userId: 15
2025-07-10 00:02:21 [http-nio-8080-exec-2] INFO  c.h.medical.service.UserService - Doctor saved successfully with id: 1
2025-07-10 00:02:21 [http-nio-8080-exec-2] INFO  c.h.medical.service.EmailService - Attempting to send OTP email to: tramtbse181958@fpt.edu.vn
2025-07-10 00:02:26 [http-nio-8080-exec-2] INFO  c.h.medical.service.EmailService - OTP email sent successfully to: tramtbse181958@fpt.edu.vn
2025-07-10 00:03:42 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/login
2025-07-10 00:03:42 [http-nio-8080-exec-6] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/auth/login with Authorization header: null
2025-07-10 00:03:42 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - No Bearer token found in request to /api/auth/login
2025-07-10 00:03:42 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/auth/login
2025-07-10 00:03:42 [http-nio-8080-exec-6] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-07-10 00:03:42 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/login
2025-07-10 00:03:42 [http-nio-8080-exec-6] INFO  c.h.medical.controller.AuthAPI - Processing login request for email: tramtbse181958@fpt.edu.vn
2025-07-10 00:03:42 [http-nio-8080-exec-6] INFO  c.h.medical.controller.AuthAPI - Generated JWT for user tramtbse181958: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE2NzAyMn0.LlwsZeLX7O12jXqmI8LqT5NpKJcoh749fdDwCbX7rzc
2025-07-10 00:03:42 [http-nio-8080-exec-6] DEBUG c.h.medical.controller.AuthAPI - Token claims - username: tramtbse181958, role: DOCTOR, fullName: BS. Nguyễn Văn K, expiresAt: Fri Jul 11 00:03:42 GMT+07:00 2025
2025-07-10 00:07:43 [http-nio-8080-exec-5] DEBUG o.s.security.web.FilterChainProxy - Securing OPTIONS /api/auth/forgot-password
2025-07-10 00:07:43 [http-nio-8080-exec-8] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/forgot-password
2025-07-10 00:07:43 [http-nio-8080-exec-8] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/auth/forgot-password with Authorization header: null
2025-07-10 00:07:43 [http-nio-8080-exec-8] DEBUG c.h.m.s.JwtAuthenticationFilter - No Bearer token found in request to /api/auth/forgot-password
2025-07-10 00:07:43 [http-nio-8080-exec-8] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/auth/forgot-password
2025-07-10 00:07:43 [http-nio-8080-exec-8] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-07-10 00:07:43 [http-nio-8080-exec-8] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/forgot-password
2025-07-10 00:07:43 [http-nio-8080-exec-8] INFO  c.h.medical.controller.AuthAPI - Processing forgot password request for email: tramtbse181958@fpt.edu.vn
2025-07-10 00:07:43 [http-nio-8080-exec-8] INFO  c.h.medical.service.EmailService - Attempting to send OTP email to: tramtbse181958@fpt.edu.vn
2025-07-10 00:07:47 [http-nio-8080-exec-8] INFO  c.h.medical.service.EmailService - OTP email sent successfully to: tramtbse181958@fpt.edu.vn
2025-07-10 00:08:07 [http-nio-8080-exec-9] DEBUG o.s.security.web.FilterChainProxy - Securing OPTIONS /api/auth/reset-password-otp
2025-07-10 00:08:07 [http-nio-8080-exec-10] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/reset-password-otp
2025-07-10 00:08:07 [http-nio-8080-exec-10] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/auth/reset-password-otp with Authorization header: null
2025-07-10 00:08:07 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - No Bearer token found in request to /api/auth/reset-password-otp
2025-07-10 00:08:07 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/auth/reset-password-otp
2025-07-10 00:08:07 [http-nio-8080-exec-10] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-07-10 00:08:07 [http-nio-8080-exec-10] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/reset-password-otp
2025-07-10 00:08:07 [http-nio-8080-exec-10] INFO  c.h.medical.controller.AuthAPI - Processing reset password OTP for email: tramtbse181958@fpt.edu.vn
2025-07-10 00:08:13 [http-nio-8080-exec-3] DEBUG o.s.security.web.FilterChainProxy - Securing OPTIONS /api/auth/login
2025-07-10 00:08:13 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/login
2025-07-10 00:08:13 [http-nio-8080-exec-2] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/auth/login with Authorization header: null
2025-07-10 00:08:13 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - No Bearer token found in request to /api/auth/login
2025-07-10 00:08:13 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/auth/login
2025-07-10 00:08:13 [http-nio-8080-exec-2] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-07-10 00:08:13 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/login
2025-07-10 00:08:13 [http-nio-8080-exec-2] INFO  c.h.medical.controller.AuthAPI - Processing login request for email: tramtbse181958@fpt.edu.vn
2025-07-10 00:08:13 [http-nio-8080-exec-2] INFO  c.h.medical.controller.AuthAPI - Generated JWT for user tramtbse181958: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE2NzI5M30.h3CeRhRuS0OwocsM5kGNoood8AX0bFy5561wwS8X5s4
2025-07-10 00:08:13 [http-nio-8080-exec-2] DEBUG c.h.medical.controller.AuthAPI - Token claims - username: tramtbse181958, role: DOCTOR, fullName: BS. Nguyễn Văn K, expiresAt: Fri Jul 11 00:08:13 GMT+07:00 2025
2025-07-10 00:29:35 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/admin/doctors/official
2025-07-10 00:29:35 [http-nio-8080-exec-6] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/admin/doctors/official with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6IkFETUlOIiwiZnVsbE5hbWUiOiJhZG1pbiIsImV4cCI6MTc1MjE2NjIzMH0.jQVcERIaM0bg-F2-lZpq9RKbkzTKgpC4eFptVFmooCo
2025-07-10 00:29:35 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6IkFETUlOIiwiZnVsbE5hbWUiOiJhZG1pbiIsImV4cCI6MTc1MjE2NjIzMH0.jQVcERIaM0bg-F2-lZpq9RKbkzTKgpC4eFptVFmooCo
2025-07-10 00:29:35 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 00:29:35 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 00:29:35 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 00:29:35 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: admin, role: ADMIN
2025-07-10 00:29:35 [http-nio-8080-exec-6] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/admin/doctors/official - username: admin, role: ADMIN
2025-07-10 00:29:35 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: admin with role: ADMIN for request to /api/admin/doctors/official
2025-07-10 00:29:35 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/admin/doctors/official
2025-07-10 00:29:35 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/admin/doctors/official
2025-07-10 00:29:35 [http-nio-8080-exec-6] INFO  c.h.medical.service.UserService - Creating doctor account for email: tramtbse181958@fpt.edu.vn
2025-07-10 00:29:35 [http-nio-8080-exec-6] INFO  c.h.medical.service.UserService - User saved successfully with userId: 16
2025-07-10 00:29:35 [http-nio-8080-exec-6] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 2627, SQLState: 23000
2025-07-10 00:29:35 [http-nio-8080-exec-6] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Violation of UNIQUE KEY constraint 'UKcaifv0va46t2mu85cg5afmayf'. Cannot insert duplicate key in object 'dbo.doctors'. The duplicate key value is (tramtbse181958@fpt.edu.vn).
2025-07-10 00:29:35 [http-nio-8080-exec-6] ERROR c.h.medical.service.UserService - Failed to save doctor: could not execute statement [Violation of UNIQUE KEY constraint 'UKcaifv0va46t2mu85cg5afmayf'. Cannot insert duplicate key in object 'dbo.doctors'. The duplicate key value is (tramtbse181958@fpt.edu.vn).] [insert into doctors (created_at,email,full_name,image_url,phone_number,qualification,specialization,updated_at,working_schedule) values (?,?,?,?,?,?,?,?,?)]; SQL [insert into doctors (created_at,email,full_name,image_url,phone_number,qualification,specialization,updated_at,working_schedule) values (?,?,?,?,?,?,?,?,?)]; constraint [UKcaifv0va46t2mu85cg5afmayf]
2025-07-10 00:29:48 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 00:29:48 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 00:29:48 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:29:48 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 00:29:48 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 00:29:54 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 18744 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 00:29:54 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 00:29:54 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 00:29:55 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 00:29:55 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 67 ms. Found 9 JPA repository interfaces.
2025-07-10 00:29:56 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 00:29:56 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 00:29:56 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 00:29:56 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 00:29:56 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1880 ms
2025-07-10 00:29:56 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 00:29:56 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 00:29:56 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 00:29:56 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 00:29:57 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 00:29:57 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 00:29:57 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 00:29:58 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 42dcf9c0-de53-4f49-9bb6-48129533a269
2025-07-10 00:29:58 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 00:29:58 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 00:29:58 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 00:30:00 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 00:30:01 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table doctors 
       add user_id bigint not null" via JDBC [ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'user_id' cannot be added to non-empty table 'doctors' because it does not satisfy these conditions.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table doctors 
       add user_id bigint not null" via JDBC [ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'user_id' cannot be added to non-empty table 'doctors' because it does not satisfy these conditions.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.migrateTable(AbstractSchemaMigrator.java:334)
	at org.hibernate.tool.schema.internal.GroupedSchemaMigratorImpl.performTablesMigration(GroupedSchemaMigratorImpl.java:84)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:233)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'user_id' cannot be added to non-empty table 'doctors' because it does not satisfy these conditions.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 37 common frames omitted
2025-07-10 00:30:01 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table doctors 
       add constraint FKe9pf5qtxxkdyrwibaevo9frtk 
       foreign key (user_id) 
       references users" via JDBC [Foreign key 'FKe9pf5qtxxkdyrwibaevo9frtk' references invalid column 'user_id' in referencing table 'doctors'.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table doctors 
       add constraint FKe9pf5qtxxkdyrwibaevo9frtk 
       foreign key (user_id) 
       references users" via JDBC [Foreign key 'FKe9pf5qtxxkdyrwibaevo9frtk' references invalid column 'user_id' in referencing table 'doctors'.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applyForeignKeys(AbstractSchemaMigrator.java:448)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:269)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: Foreign key 'FKe9pf5qtxxkdyrwibaevo9frtk' references invalid column 'user_id' in referencing table 'doctors'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 36 common frames omitted
2025-07-10 00:30:01 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table patient_treatment_plans 
       add constraint FKcbowcevtj6qcbcui5d9gm8h31 
       foreign key (doctor_id) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FKcbowcevtj6qcbcui5d9gm8h31". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table patient_treatment_plans 
       add constraint FKcbowcevtj6qcbcui5d9gm8h31 
       foreign key (doctor_id) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FKcbowcevtj6qcbcui5d9gm8h31". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applyForeignKeys(AbstractSchemaMigrator.java:448)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:269)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FKcbowcevtj6qcbcui5d9gm8h31". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 36 common frames omitted
2025-07-10 00:30:01 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table schedule 
       add constraint FK2xgwttjn6bxcrnserm1g7hg4x 
       foreign key (doctor_id) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2xgwttjn6bxcrnserm1g7hg4x". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table schedule 
       add constraint FK2xgwttjn6bxcrnserm1g7hg4x 
       foreign key (doctor_id) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2xgwttjn6bxcrnserm1g7hg4x". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applyForeignKeys(AbstractSchemaMigrator.java:448)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:269)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2xgwttjn6bxcrnserm1g7hg4x". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 36 common frames omitted
2025-07-10 00:30:01 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table treatment_plan_templates 
       add constraint FK2prxn7dedffni6w7rrv6v8d3y 
       foreign key (created_by) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2prxn7dedffni6w7rrv6v8d3y". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table treatment_plan_templates 
       add constraint FK2prxn7dedffni6w7rrv6v8d3y 
       foreign key (created_by) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2prxn7dedffni6w7rrv6v8d3y". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applyForeignKeys(AbstractSchemaMigrator.java:448)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:269)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2prxn7dedffni6w7rrv6v8d3y". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 36 common frames omitted
2025-07-10 00:30:01 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:30:02 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 00:30:04 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 00:30:04 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 00:30:04 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 00:30:04 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 00:30:04 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 00:30:04 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 00:30:05 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 00:30:05 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 11.224 seconds (process running for 12.228)
2025-07-10 00:32:04 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-10 00:32:04 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-10 00:32:04 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-07-10 00:32:04 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/login
2025-07-10 00:32:04 [http-nio-8080-exec-2] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/auth/login with Authorization header: null
2025-07-10 00:32:04 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - No Bearer token found in request to /api/auth/login
2025-07-10 00:32:04 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/auth/login
2025-07-10 00:32:04 [http-nio-8080-exec-2] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-07-10 00:32:04 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/login
2025-07-10 00:32:04 [http-nio-8080-exec-2] INFO  c.h.medical.controller.AuthAPI - Processing login request for email: admin@example.com
2025-07-10 00:32:05 [http-nio-8080-exec-2] INFO  c.h.medical.controller.AuthAPI - Generated JWT for user admin: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6IkFETUlOIiwiZnVsbE5hbWUiOiJhZG1pbiIsImV4cCI6MTc1MjE2ODcyNX0.LNNVh99w2bsBaYqUoWTBc_NV8OVAvHEJAz9wdSphMuM
2025-07-10 00:32:05 [http-nio-8080-exec-2] DEBUG c.h.medical.controller.AuthAPI - Token claims - username: admin, role: ADMIN, fullName: null, expiresAt: Fri Jul 11 00:32:05 GMT+07:00 2025
2025-07-10 00:32:28 [http-nio-8080-exec-3] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/admin/doctors/official
2025-07-10 00:32:28 [http-nio-8080-exec-3] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/admin/doctors/official with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6IkFETUlOIiwiZnVsbE5hbWUiOiJhZG1pbiIsImV4cCI6MTc1MjE2ODcyNX0.LNNVh99w2bsBaYqUoWTBc_NV8OVAvHEJAz9wdSphMuM
2025-07-10 00:32:28 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6IkFETUlOIiwiZnVsbE5hbWUiOiJhZG1pbiIsImV4cCI6MTc1MjE2ODcyNX0.LNNVh99w2bsBaYqUoWTBc_NV8OVAvHEJAz9wdSphMuM
2025-07-10 00:32:28 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 00:32:28 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 00:32:28 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 00:32:28 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: admin, role: ADMIN
2025-07-10 00:32:28 [http-nio-8080-exec-3] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/admin/doctors/official - username: admin, role: ADMIN
2025-07-10 00:32:28 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: admin with role: ADMIN for request to /api/admin/doctors/official
2025-07-10 00:32:28 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/admin/doctors/official
2025-07-10 00:32:28 [http-nio-8080-exec-3] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/admin/doctors/official
2025-07-10 00:32:28 [http-nio-8080-exec-3] INFO  c.h.medical.service.UserService - Starting creation of doctor account for email: tramtbse181958@fpt.edu.vn
2025-07-10 00:32:28 [http-nio-8080-exec-3] INFO  c.h.medical.service.UserService - User saved successfully with userId: 17
2025-07-10 00:32:28 [http-nio-8080-exec-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 207, SQLState: S0001
2025-07-10 00:32:28 [http-nio-8080-exec-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Invalid column name 'user_id'.
2025-07-10 00:32:29 [http-nio-8080-exec-3] ERROR c.h.medical.service.UserService - Failed to save doctor: could not execute statement [Invalid column name 'user_id'.] [insert into doctors (created_at,email,full_name,image_url,phone_number,qualification,specialization,updated_at,user_id,working_schedule) values (?,?,?,?,?,?,?,?,?,?)]; SQL [insert into doctors (created_at,email,full_name,image_url,phone_number,qualification,specialization,updated_at,user_id,working_schedule) values (?,?,?,?,?,?,?,?,?,?)], Stack trace: [org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281), org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256), org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241), org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560), org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61), org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343), org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160), org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184), org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165), org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184), org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223), jdk.proxy2/jdk.proxy2.$Proxy140.save(Unknown Source), com.hivmedical.medical.service.UserService.createOfficialDoctorAccount(UserService.java:202), com.hivmedical.medical.controller.AdminController.createOfficialDoctorAccount(AdminController.java:45), java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104), java.base/java.lang.reflect.Method.invoke(Method.java:565), org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258), org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191), org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118), org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986), org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891), org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87), org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089), org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979), org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014), org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914), jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590), org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885), jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140), org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140), org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108), org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108), org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231), org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:365), org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:101), org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374), org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:125), org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:119), org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374), org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:131), org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85), org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374), org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100), org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374), org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179), org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374), org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63), org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374), com.hivmedical.medical.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:91), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116), org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374), org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107), org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93), org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374), org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116), org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374), org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90), org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116), org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374), org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82), org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69), org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374), org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116), org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374), org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116), org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374), org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233), org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191), org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113), org.springframework.web.filter.ServletRequestPathFilter.doFilter(ServletRequestPathFilter.java:52), org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113), org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74), org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebSecurityConfiguration.java:319), org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113), org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$4(HandlerMappingIntrospector.java:267), org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113), org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74), org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:240), org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362), org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140), org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140), org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140), org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201), org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116), org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164), org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140), org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167), org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90), org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483), org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116), org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93), org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74), org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344), org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398), org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63), org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903), org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769), org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52), org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189), org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658), org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63), java.base/java.lang.Thread.run(Thread.java:1447)]
2025-07-10 00:34:21 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 00:34:21 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 00:34:21 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:34:21 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 00:34:21 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 00:34:24 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 13400 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 00:34:24 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 00:34:24 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 00:34:25 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 00:34:25 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 74 ms. Found 9 JPA repository interfaces.
2025-07-10 00:34:26 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 00:34:26 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 00:34:26 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 00:34:26 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 00:34:26 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1806 ms
2025-07-10 00:34:26 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 00:34:26 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 00:34:26 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 00:34:26 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 00:34:26 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 00:34:26 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 00:34:26 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 00:34:27 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 012b2cb1-db83-44e7-9f7e-14a0b1a05b49
2025-07-10 00:34:27 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 00:34:27 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 00:34:27 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 00:34:29 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 00:34:29 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table doctors 
       add user_id bigint not null" via JDBC [ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'user_id' cannot be added to non-empty table 'doctors' because it does not satisfy these conditions.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table doctors 
       add user_id bigint not null" via JDBC [ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'user_id' cannot be added to non-empty table 'doctors' because it does not satisfy these conditions.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.migrateTable(AbstractSchemaMigrator.java:334)
	at org.hibernate.tool.schema.internal.GroupedSchemaMigratorImpl.performTablesMigration(GroupedSchemaMigratorImpl.java:84)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:233)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'user_id' cannot be added to non-empty table 'doctors' because it does not satisfy these conditions.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 37 common frames omitted
2025-07-10 00:34:30 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table doctors 
       add constraint FKe9pf5qtxxkdyrwibaevo9frtk 
       foreign key (user_id) 
       references users" via JDBC [Foreign key 'FKe9pf5qtxxkdyrwibaevo9frtk' references invalid column 'user_id' in referencing table 'doctors'.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table doctors 
       add constraint FKe9pf5qtxxkdyrwibaevo9frtk 
       foreign key (user_id) 
       references users" via JDBC [Foreign key 'FKe9pf5qtxxkdyrwibaevo9frtk' references invalid column 'user_id' in referencing table 'doctors'.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applyForeignKeys(AbstractSchemaMigrator.java:448)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:269)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: Foreign key 'FKe9pf5qtxxkdyrwibaevo9frtk' references invalid column 'user_id' in referencing table 'doctors'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 36 common frames omitted
2025-07-10 00:34:30 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table patient_treatment_plans 
       add constraint FKcbowcevtj6qcbcui5d9gm8h31 
       foreign key (doctor_id) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FKcbowcevtj6qcbcui5d9gm8h31". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table patient_treatment_plans 
       add constraint FKcbowcevtj6qcbcui5d9gm8h31 
       foreign key (doctor_id) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FKcbowcevtj6qcbcui5d9gm8h31". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applyForeignKeys(AbstractSchemaMigrator.java:448)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:269)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FKcbowcevtj6qcbcui5d9gm8h31". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 36 common frames omitted
2025-07-10 00:34:30 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table treatment_plan_templates 
       add constraint FK2prxn7dedffni6w7rrv6v8d3y 
       foreign key (created_by) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2prxn7dedffni6w7rrv6v8d3y". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table treatment_plan_templates 
       add constraint FK2prxn7dedffni6w7rrv6v8d3y 
       foreign key (created_by) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2prxn7dedffni6w7rrv6v8d3y". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applyForeignKeys(AbstractSchemaMigrator.java:448)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:269)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2prxn7dedffni6w7rrv6v8d3y". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 36 common frames omitted
2025-07-10 00:34:30 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:34:31 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 00:34:33 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 00:34:33 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 00:34:33 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 00:34:33 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 00:34:34 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 00:34:34 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 00:34:34 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 00:34:34 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 11.231 seconds (process running for 12.26)
2025-07-10 00:42:45 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 00:42:45 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 00:42:45 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:42:45 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 00:42:45 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 00:42:48 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 7684 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 00:42:48 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 00:42:48 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 00:42:49 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 00:42:49 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 65 ms. Found 9 JPA repository interfaces.
2025-07-10 00:42:49 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 00:42:49 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 00:42:49 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 00:42:49 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 00:42:49 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1399 ms
2025-07-10 00:42:49 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 00:42:49 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 00:42:50 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 00:42:50 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 00:42:50 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 00:42:50 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 00:42:50 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 00:42:50 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: f67d67ae-b515-45e0-a89d-05e131d31147
2025-07-10 00:42:50 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 00:42:50 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 00:42:50 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 00:42:51 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 00:42:52 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table doctors 
       add user_id bigint not null" via JDBC [ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'user_id' cannot be added to non-empty table 'doctors' because it does not satisfy these conditions.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table doctors 
       add user_id bigint not null" via JDBC [ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'user_id' cannot be added to non-empty table 'doctors' because it does not satisfy these conditions.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.migrateTable(AbstractSchemaMigrator.java:334)
	at org.hibernate.tool.schema.internal.GroupedSchemaMigratorImpl.performTablesMigration(GroupedSchemaMigratorImpl.java:84)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:233)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'user_id' cannot be added to non-empty table 'doctors' because it does not satisfy these conditions.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 37 common frames omitted
2025-07-10 00:42:53 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table doctors 
       add constraint FKe9pf5qtxxkdyrwibaevo9frtk 
       foreign key (user_id) 
       references users" via JDBC [Foreign key 'FKe9pf5qtxxkdyrwibaevo9frtk' references invalid column 'user_id' in referencing table 'doctors'.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table doctors 
       add constraint FKe9pf5qtxxkdyrwibaevo9frtk 
       foreign key (user_id) 
       references users" via JDBC [Foreign key 'FKe9pf5qtxxkdyrwibaevo9frtk' references invalid column 'user_id' in referencing table 'doctors'.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applyForeignKeys(AbstractSchemaMigrator.java:448)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:269)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: Foreign key 'FKe9pf5qtxxkdyrwibaevo9frtk' references invalid column 'user_id' in referencing table 'doctors'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 36 common frames omitted
2025-07-10 00:42:53 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table patient_treatment_plans 
       add constraint FKcbowcevtj6qcbcui5d9gm8h31 
       foreign key (doctor_id) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FKcbowcevtj6qcbcui5d9gm8h31". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table patient_treatment_plans 
       add constraint FKcbowcevtj6qcbcui5d9gm8h31 
       foreign key (doctor_id) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FKcbowcevtj6qcbcui5d9gm8h31". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applyForeignKeys(AbstractSchemaMigrator.java:448)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:269)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FKcbowcevtj6qcbcui5d9gm8h31". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 36 common frames omitted
2025-07-10 00:42:55 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table treatment_plan_templates 
       add constraint FK2prxn7dedffni6w7rrv6v8d3y 
       foreign key (created_by) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2prxn7dedffni6w7rrv6v8d3y". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table treatment_plan_templates 
       add constraint FK2prxn7dedffni6w7rrv6v8d3y 
       foreign key (created_by) 
       references doctors" via JDBC [The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2prxn7dedffni6w7rrv6v8d3y". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applyForeignKeys(AbstractSchemaMigrator.java:448)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:269)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "FK2prxn7dedffni6w7rrv6v8d3y". The conflict occurred in database "hiv_medical", table "dbo.doctors", column 'id'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 36 common frames omitted
2025-07-10 00:42:55 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:42:55 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 00:42:56 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 00:42:56 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 00:42:56 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 00:42:56 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 00:42:56 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 00:42:56 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 00:42:57 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 00:42:57 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 9.478 seconds (process running for 10.376)
2025-07-10 00:44:08 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 00:44:08 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 00:44:08 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:44:08 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 00:44:08 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 00:44:12 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 17540 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 00:44:12 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 00:44:12 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 00:44:13 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 00:44:13 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 80 ms. Found 9 JPA repository interfaces.
2025-07-10 00:44:13 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 00:44:13 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 00:44:13 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 00:44:13 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 00:44:13 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1309 ms
2025-07-10 00:44:13 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 00:44:13 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 00:44:14 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 00:44:14 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 00:44:14 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 00:44:14 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 00:44:14 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 00:44:14 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 1fe873bf-5ff6-4f7c-9955-a21e8e8f3e32
2025-07-10 00:44:14 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 00:44:14 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 00:44:14 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 00:44:15 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 00:44:16 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:44:17 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 00:44:17 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 00:44:17 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 00:44:18 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 00:44:18 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 00:44:18 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 00:44:18 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 00:44:18 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 00:44:18 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 6.478 seconds (process running for 7.255)
2025-07-10 00:45:30 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 00:45:30 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 00:45:30 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:45:30 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 00:45:30 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 00:45:34 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 10080 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 00:45:34 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 00:45:34 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 00:45:35 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 00:45:35 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 92 ms. Found 9 JPA repository interfaces.
2025-07-10 00:45:36 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 00:45:36 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 00:45:36 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 00:45:36 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 00:45:36 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1999 ms
2025-07-10 00:45:36 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 00:45:36 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 00:45:36 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 00:45:36 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 00:45:36 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 00:45:37 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 00:45:37 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 00:45:37 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: a53a21ee-2e54-462b-b669-237e986cf882
2025-07-10 00:45:37 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 00:45:37 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 00:45:37 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 00:45:39 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 00:45:39 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:45:40 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 00:45:41 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 00:45:41 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 00:45:41 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 00:45:41 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 00:45:41 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 00:45:41 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 00:45:42 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 00:45:42 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 8.028 seconds (process running for 8.865)
2025-07-10 00:46:25 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 00:46:25 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 00:46:25 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:46:25 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 00:46:25 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 00:46:27 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 24464 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 00:46:27 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 00:46:27 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 00:46:28 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 00:46:28 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 61 ms. Found 9 JPA repository interfaces.
2025-07-10 00:46:28 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 00:46:28 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 00:46:28 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 00:46:28 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 00:46:28 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1350 ms
2025-07-10 00:46:28 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 00:46:29 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 00:46:29 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 00:46:29 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 00:46:29 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 00:46:29 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 00:46:29 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 00:46:29 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 5a48ecca-5667-4b5c-b728-ccf9b38b3355
2025-07-10 00:46:29 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 00:46:30 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 00:46:30 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 00:46:31 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 00:46:32 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:46:32 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 00:46:33 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 00:46:33 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 00:46:33 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 00:46:33 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 00:46:33 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 00:46:33 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 00:46:34 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 00:46:34 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 7.238 seconds (process running for 8.124)
2025-07-10 00:54:49 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 00:54:49 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 00:54:49 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:54:49 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 00:54:49 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 00:54:52 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 19608 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 00:54:52 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 00:54:52 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 00:54:53 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 00:54:53 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 77 ms. Found 9 JPA repository interfaces.
2025-07-10 00:54:54 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 00:54:54 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 00:54:54 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 00:54:54 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 00:54:54 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1774 ms
2025-07-10 00:54:54 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 00:54:54 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 00:54:54 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 00:54:54 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 00:54:54 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 00:54:54 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 00:54:54 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 00:54:55 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: dbe5dc7d-f44f-46fe-af8f-01bcb7c0b5e6
2025-07-10 00:54:55 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 00:54:55 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 00:54:55 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 00:54:56 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 00:54:57 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:54:57 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 00:54:58 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 00:54:58 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 00:54:58 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 00:54:58 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 00:54:59 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 00:54:59 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 00:54:59 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 00:54:59 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 7.603 seconds (process running for 8.569)
2025-07-10 00:55:29 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 00:55:29 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 00:55:29 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:55:29 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 00:55:29 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 00:58:21 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 14560 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 00:58:21 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 00:58:21 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 00:58:22 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 00:58:22 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 62 ms. Found 9 JPA repository interfaces.
2025-07-10 00:58:23 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 00:58:23 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 00:58:23 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 00:58:23 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 00:58:23 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1599 ms
2025-07-10 00:58:23 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 00:58:23 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 00:58:23 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 00:58:23 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 00:58:23 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 00:58:23 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 00:58:23 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 00:58:24 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 7ced0626-648b-4a69-9bd1-0546384e3851
2025-07-10 00:58:24 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 00:58:24 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 00:58:24 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 00:58:25 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 00:58:26 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 00:58:26 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 00:58:27 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 00:58:27 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 00:58:27 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 00:58:27 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 00:58:27 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 00:58:27 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 00:58:27 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 00:58:27 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 6.932 seconds (process running for 7.938)
2025-07-10 01:03:56 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 01:03:56 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 01:03:56 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 01:03:56 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 01:03:56 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 01:03:59 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 17056 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 01:03:59 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 01:03:59 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 01:04:00 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 01:04:00 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 67 ms. Found 9 JPA repository interfaces.
2025-07-10 01:04:00 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 01:04:00 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 01:04:00 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 01:04:00 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 01:04:00 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1768 ms
2025-07-10 01:04:00 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 01:04:01 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 01:04:01 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 01:04:01 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 01:04:01 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 01:04:02 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 01:04:02 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 01:04:02 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 78ee9fa0-a888-4c93-aa2c-1cd10c10717c
2025-07-10 01:04:02 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 01:04:02 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 01:04:02 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 01:04:04 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 01:04:05 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 01:04:06 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 01:04:08 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 01:04:08 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 01:04:09 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 01:04:09 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 01:04:09 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 01:04:09 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 01:04:10 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 01:04:10 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 12.167 seconds (process running for 13.207)
2025-07-10 01:04:31 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-10 01:04:31 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-10 01:04:31 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-07-10 01:04:31 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/admin/doctors/official
2025-07-10 01:04:31 [http-nio-8080-exec-1] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/admin/doctors/official with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6IkFETUlOIiwiZnVsbE5hbWUiOiJhZG1pbiIsImV4cCI6MTc1MjE2ODcyNX0.LNNVh99w2bsBaYqUoWTBc_NV8OVAvHEJAz9wdSphMuM
2025-07-10 01:04:31 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6IkFETUlOIiwiZnVsbE5hbWUiOiJhZG1pbiIsImV4cCI6MTc1MjE2ODcyNX0.LNNVh99w2bsBaYqUoWTBc_NV8OVAvHEJAz9wdSphMuM
2025-07-10 01:04:31 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 01:04:31 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 01:04:31 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 01:04:31 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: admin, role: ADMIN
2025-07-10 01:04:31 [http-nio-8080-exec-1] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/admin/doctors/official - username: admin, role: ADMIN
2025-07-10 01:04:31 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: admin with role: ADMIN for request to /api/admin/doctors/official
2025-07-10 01:04:31 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/admin/doctors/official
2025-07-10 01:04:31 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/admin/doctors/official
2025-07-10 01:04:31 [http-nio-8080-exec-1] INFO  c.h.medical.service.UserService - Starting creation of doctor account for email: tramtbse181958@fpt.edu.vn
2025-07-10 01:04:32 [http-nio-8080-exec-1] INFO  c.h.medical.service.UserService - User saved successfully with userId: 18
2025-07-10 01:04:32 [http-nio-8080-exec-1] INFO  c.h.medical.service.UserService - Doctor saved successfully with id: 14
2025-07-10 01:04:32 [http-nio-8080-exec-1] INFO  c.h.medical.service.EmailService - Attempting to send OTP email to: tramtbse181958@fpt.edu.vn
2025-07-10 01:04:36 [http-nio-8080-exec-1] INFO  c.h.medical.service.EmailService - OTP email sent successfully to: tramtbse181958@fpt.edu.vn
2025-07-10 01:05:27 [http-nio-8080-exec-5] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/login
2025-07-10 01:05:27 [http-nio-8080-exec-5] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/auth/login with Authorization header: null
2025-07-10 01:05:27 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - No Bearer token found in request to /api/auth/login
2025-07-10 01:05:27 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/auth/login
2025-07-10 01:05:27 [http-nio-8080-exec-5] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-07-10 01:05:27 [http-nio-8080-exec-5] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/login
2025-07-10 01:05:27 [http-nio-8080-exec-5] INFO  c.h.medical.controller.AuthAPI - Processing login request for email: tramtbse181958@fpt.edu.vn
2025-07-10 01:05:27 [http-nio-8080-exec-5] INFO  c.h.medical.controller.AuthAPI - Generated JWT for user tramtbse181958: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MDcyN30.KOhThztAvkKeejIOcib3Tgq4nRyZoeXFhKDoJ_wf5_U
2025-07-10 01:05:27 [http-nio-8080-exec-5] DEBUG c.h.medical.controller.AuthAPI - Token claims - username: tramtbse181958, role: DOCTOR, fullName: BS. Nguyễn Văn K, expiresAt: Fri Jul 11 01:05:27 GMT+07:00 2025
2025-07-10 01:12:32 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 01:12:32 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 01:12:32 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 01:12:32 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 01:12:32 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 01:12:37 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 20936 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 01:12:37 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 01:12:37 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 01:12:38 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 01:12:38 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 89 ms. Found 9 JPA repository interfaces.
2025-07-10 01:12:39 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 01:12:39 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 01:12:39 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 01:12:39 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 01:12:39 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1967 ms
2025-07-10 01:12:39 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 01:12:39 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 01:12:40 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 01:12:40 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 01:12:40 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 01:12:40 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 01:12:40 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 01:12:41 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 9d4a8e8e-c9eb-4713-9d51-e8c46e815ec8
2025-07-10 01:12:41 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 01:12:41 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 01:12:41 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 01:12:42 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 01:12:43 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 01:12:44 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 01:12:45 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 01:12:45 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 01:12:45 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 01:12:45 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 01:12:45 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 01:12:45 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 01:12:46 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 01:12:46 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 8.906 seconds (process running for 9.913)
2025-07-10 01:17:48 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-10 01:17:48 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-10 01:17:48 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-07-10 01:17:48 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Securing OPTIONS /api/auth/forgot-password
2025-07-10 01:17:48 [http-nio-8080-exec-3] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/forgot-password
2025-07-10 01:17:48 [http-nio-8080-exec-3] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/auth/forgot-password with Authorization header: null
2025-07-10 01:17:48 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - No Bearer token found in request to /api/auth/forgot-password
2025-07-10 01:17:48 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/auth/forgot-password
2025-07-10 01:17:48 [http-nio-8080-exec-3] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-07-10 01:17:48 [http-nio-8080-exec-3] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/forgot-password
2025-07-10 01:17:48 [http-nio-8080-exec-3] INFO  c.h.medical.controller.AuthAPI - Processing forgot password request for email: tramtbse181958@fpt.edu.vn
2025-07-10 01:17:48 [http-nio-8080-exec-3] INFO  c.h.medical.service.EmailService - Attempting to send OTP email to: tramtbse181958@fpt.edu.vn
2025-07-10 01:17:52 [http-nio-8080-exec-3] INFO  c.h.medical.service.EmailService - OTP email sent successfully to: tramtbse181958@fpt.edu.vn
2025-07-10 01:18:10 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing OPTIONS /api/auth/reset-password-otp
2025-07-10 01:18:10 [http-nio-8080-exec-4] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/reset-password-otp
2025-07-10 01:18:10 [http-nio-8080-exec-4] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/auth/reset-password-otp with Authorization header: null
2025-07-10 01:18:10 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - No Bearer token found in request to /api/auth/reset-password-otp
2025-07-10 01:18:10 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/auth/reset-password-otp
2025-07-10 01:18:10 [http-nio-8080-exec-4] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-07-10 01:18:10 [http-nio-8080-exec-4] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/reset-password-otp
2025-07-10 01:18:10 [http-nio-8080-exec-4] INFO  c.h.medical.controller.AuthAPI - Processing reset password OTP for email: tramtbse181958@fpt.edu.vn
2025-07-10 01:18:24 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/login
2025-07-10 01:18:24 [http-nio-8080-exec-6] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/auth/login with Authorization header: null
2025-07-10 01:18:24 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - No Bearer token found in request to /api/auth/login
2025-07-10 01:18:24 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/auth/login
2025-07-10 01:18:24 [http-nio-8080-exec-6] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-07-10 01:18:24 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/login
2025-07-10 01:18:24 [http-nio-8080-exec-6] INFO  c.h.medical.controller.AuthAPI - Processing login request for email: tramtbse181958@fpt.edu.vn
2025-07-10 01:18:25 [http-nio-8080-exec-6] INFO  c.h.medical.controller.AuthAPI - Generated JWT for user tramtbse181958: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MTUwNX0.XqaQrMqMWEE3wx_n29FsKDrdXnfVQzXqJzC0z15-LyY
2025-07-10 01:18:25 [http-nio-8080-exec-6] DEBUG c.h.medical.controller.AuthAPI - Token claims - username: tramtbse181958, role: DOCTOR, fullName: BS. Nguyễn Văn K, expiresAt: Fri Jul 11 01:18:25 GMT+07:00 2025
2025-07-10 01:19:35 [http-nio-8080-exec-10] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/templates
2025-07-10 01:19:35 [http-nio-8080-exec-10] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/templates with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MTUwNX0.XqaQrMqMWEE3wx_n29FsKDrdXnfVQzXqJzC0z15-LyY
2025-07-10 01:19:35 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MTUwNX0.XqaQrMqMWEE3wx_n29FsKDrdXnfVQzXqJzC0z15-LyY
2025-07-10 01:19:35 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 01:19:35 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 01:19:35 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 01:19:35 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 01:19:35 [http-nio-8080-exec-10] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/templates - username: tramtbse181958, role: DOCTOR
2025-07-10 01:19:35 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/treatment-plans/templates
2025-07-10 01:19:35 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/templates
2025-07-10 01:19:35 [http-nio-8080-exec-10] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/templates
2025-07-10 01:24:35 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 01:24:35 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 01:24:35 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 01:24:35 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 01:24:35 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 01:31:35 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 6268 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 01:31:35 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 01:31:35 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 01:31:36 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 01:31:36 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 67 ms. Found 9 JPA repository interfaces.
2025-07-10 01:31:37 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 01:31:37 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 01:31:37 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 01:31:37 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 01:31:37 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1982 ms
2025-07-10 01:31:37 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 01:31:37 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 01:31:37 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 01:31:37 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 01:31:37 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 01:31:37 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 01:31:37 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 01:31:38 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: cd50ebbf-ea61-4e9c-bb7f-1c17d406ed5a
2025-07-10 01:31:38 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 01:31:38 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 01:31:38 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 01:31:39 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 01:31:40 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table treatment_plan_templates 
       add user_id bigint not null" via JDBC [ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'user_id' cannot be added to non-empty table 'treatment_plan_templates' because it does not satisfy these conditions.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table treatment_plan_templates 
       add user_id bigint not null" via JDBC [ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'user_id' cannot be added to non-empty table 'treatment_plan_templates' because it does not satisfy these conditions.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.migrateTable(AbstractSchemaMigrator.java:334)
	at org.hibernate.tool.schema.internal.GroupedSchemaMigratorImpl.performTablesMigration(GroupedSchemaMigratorImpl.java:84)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:233)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'user_id' cannot be added to non-empty table 'treatment_plan_templates' because it does not satisfy these conditions.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 37 common frames omitted
2025-07-10 01:31:41 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table treatment_plan_templates 
       add constraint FKqfljad4jrm0yvx20qbixvl3ud 
       foreign key (user_id) 
       references users" via JDBC [Foreign key 'FKqfljad4jrm0yvx20qbixvl3ud' references invalid column 'user_id' in referencing table 'treatment_plan_templates'.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table treatment_plan_templates 
       add constraint FKqfljad4jrm0yvx20qbixvl3ud 
       foreign key (user_id) 
       references users" via JDBC [Foreign key 'FKqfljad4jrm0yvx20qbixvl3ud' references invalid column 'user_id' in referencing table 'treatment_plan_templates'.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applyForeignKeys(AbstractSchemaMigrator.java:448)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:269)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: Foreign key 'FKqfljad4jrm0yvx20qbixvl3ud' references invalid column 'user_id' in referencing table 'treatment_plan_templates'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 36 common frames omitted
2025-07-10 01:31:41 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 01:31:41 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 01:31:42 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 01:31:42 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 01:31:42 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 01:31:42 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 01:31:43 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 01:31:43 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 01:31:43 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 01:31:43 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 9.212 seconds (process running for 10.155)
2025-07-10 01:31:52 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-10 01:31:52 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-10 01:31:52 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 119 ms
2025-07-10 01:31:52 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/templates
2025-07-10 01:31:52 [http-nio-8080-exec-1] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/templates with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MTUwNX0.XqaQrMqMWEE3wx_n29FsKDrdXnfVQzXqJzC0z15-LyY
2025-07-10 01:31:52 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MTUwNX0.XqaQrMqMWEE3wx_n29FsKDrdXnfVQzXqJzC0z15-LyY
2025-07-10 01:31:52 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 01:31:52 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 01:31:53 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 01:31:53 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 01:31:53 [http-nio-8080-exec-1] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/templates - username: tramtbse181958, role: DOCTOR
2025-07-10 01:31:53 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/treatment-plans/templates
2025-07-10 01:31:53 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/templates
2025-07-10 01:31:53 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/templates
2025-07-10 01:31:53 [http-nio-8080-exec-1] WARN  c.h.m.service.TreatmentPlanService - Invalid JSON format for drug components, treating as text: AZT (Zidov): NRTI, ?c ch? enzyme reverse transcriptase, ngăn virus HIV sao chép. 3TC (Lamiv): NRTI, k?t h?p v?i AZT đ? tăng cư?ng hi?u qu? đi?u tr?. EFV (Efavir): NNRTI, ?c ch? reverse transcriptase khác cơ ch? v?i NRTI.
2025-07-10 01:31:53 [http-nio-8080-exec-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 207, SQLState: S0001
2025-07-10 01:31:53 [http-nio-8080-exec-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Invalid column name 'user_id'.
2025-07-10 01:32:27 [http-nio-8080-exec-4] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/templates
2025-07-10 01:32:27 [http-nio-8080-exec-4] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/templates with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MTUwNX0.XqaQrMqMWEE3wx_n29FsKDrdXnfVQzXqJzC0z15-LyY
2025-07-10 01:32:27 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MTUwNX0.XqaQrMqMWEE3wx_n29FsKDrdXnfVQzXqJzC0z15-LyY
2025-07-10 01:32:27 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 01:32:27 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 01:32:27 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 01:32:27 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 01:32:27 [http-nio-8080-exec-4] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/templates - username: tramtbse181958, role: DOCTOR
2025-07-10 01:32:27 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/treatment-plans/templates
2025-07-10 01:32:27 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/templates
2025-07-10 01:32:27 [http-nio-8080-exec-4] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/templates
2025-07-10 01:32:27 [http-nio-8080-exec-4] WARN  c.h.m.service.TreatmentPlanService - Invalid JSON format for drug components, treating as text: AZT (Zidov): NRTI, ?c ch? enzyme reverse transcriptase, ngăn virus HIV sao chép. 3TC (Lamiv): NRTI, k?t h?p v?i AZT đ? tăng cư?ng hi?u qu? đi?u tr?. EFV (Efavir): NNRTI, ?c ch? reverse transcriptase khác cơ ch? v?i NRTI.
2025-07-10 01:32:27 [http-nio-8080-exec-4] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 207, SQLState: S0001
2025-07-10 01:32:27 [http-nio-8080-exec-4] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Invalid column name 'user_id'.
2025-07-10 01:37:21 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=2m12s498ms528µs400ns).
2025-07-10 01:45:46 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 01:45:46 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 01:45:46 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 01:45:46 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 01:45:46 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 01:45:55 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 21884 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 01:45:55 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 01:45:55 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 01:45:57 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 01:45:57 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 126 ms. Found 9 JPA repository interfaces.
2025-07-10 01:45:58 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 01:45:58 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 01:45:58 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 01:45:58 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 01:45:58 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2937 ms
2025-07-10 01:45:58 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 01:45:58 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 01:45:59 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 01:45:59 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 01:45:59 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 01:45:59 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 01:45:59 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 01:46:00 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: f919f10f-871f-4986-91d9-148969bef4dc
2025-07-10 01:46:00 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 01:46:00 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 01:46:00 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 01:46:01 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 01:46:02 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table treatment_plan_templates 
       add user_id bigint not null" via JDBC [ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'user_id' cannot be added to non-empty table 'treatment_plan_templates' because it does not satisfy these conditions.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table treatment_plan_templates 
       add user_id bigint not null" via JDBC [ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'user_id' cannot be added to non-empty table 'treatment_plan_templates' because it does not satisfy these conditions.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.migrateTable(AbstractSchemaMigrator.java:334)
	at org.hibernate.tool.schema.internal.GroupedSchemaMigratorImpl.performTablesMigration(GroupedSchemaMigratorImpl.java:84)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:233)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'user_id' cannot be added to non-empty table 'treatment_plan_templates' because it does not satisfy these conditions.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 37 common frames omitted
2025-07-10 01:46:02 [main] WARN  o.h.t.s.i.ExceptionHandlerLoggedImpl - GenerationTarget encountered exception accepting command : Error executing DDL "
    alter table treatment_plan_templates 
       add constraint FKqfljad4jrm0yvx20qbixvl3ud 
       foreign key (user_id) 
       references users" via JDBC [Foreign key 'FKqfljad4jrm0yvx20qbixvl3ud' references invalid column 'user_id' in referencing table 'treatment_plan_templates'.]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Error executing DDL "
    alter table treatment_plan_templates 
       add constraint FKqfljad4jrm0yvx20qbixvl3ud 
       foreign key (user_id) 
       references users" via JDBC [Foreign key 'FKqfljad4jrm0yvx20qbixvl3ud' references invalid column 'user_id' in referencing table 'treatment_plan_templates'.]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:94)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlString(AbstractSchemaMigrator.java:576)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applySqlStrings(AbstractSchemaMigrator.java:516)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.applyForeignKeys(AbstractSchemaMigrator.java:448)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.performMigration(AbstractSchemaMigrator.java:269)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:112)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:280)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)
	at java.base/java.util.HashMap.forEach(HashMap.java:1430)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:970)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.hivmedical.medical.MedicalApplication.main(MedicalApplication.java:10)
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: Foreign key 'FKqfljad4jrm0yvx20qbixvl3ud' references invalid column 'user_id' in referencing table 'treatment_plan_templates'.
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:276)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1787)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteStatement(SQLServerStatement.java:975)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement$StmtExecCmd.doExecute(SQLServerStatement.java:869)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:7745)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:4700)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:321)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:253)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.execute(SQLServerStatement.java:842)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:80)
	... 36 common frames omitted
2025-07-10 01:46:02 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 01:46:02 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 01:46:03 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 01:46:03 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 01:46:04 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 01:46:04 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 01:46:04 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 01:46:04 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 01:46:04 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 01:46:04 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 10.481 seconds (process running for 12.177)
2025-07-10 01:50:38 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-10 01:50:38 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-10 01:50:38 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-07-10 01:50:38 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/templates
2025-07-10 01:50:38 [http-nio-8080-exec-1] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/templates with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MTUwNX0.XqaQrMqMWEE3wx_n29FsKDrdXnfVQzXqJzC0z15-LyY
2025-07-10 01:50:38 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MTUwNX0.XqaQrMqMWEE3wx_n29FsKDrdXnfVQzXqJzC0z15-LyY
2025-07-10 01:50:38 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 01:50:38 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 01:50:38 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 01:50:38 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 01:50:38 [http-nio-8080-exec-1] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/templates - username: tramtbse181958, role: DOCTOR
2025-07-10 01:50:38 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/treatment-plans/templates
2025-07-10 01:50:38 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/templates
2025-07-10 01:50:38 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/templates
2025-07-10 01:50:38 [http-nio-8080-exec-1] WARN  c.h.m.service.TreatmentPlanService - Invalid JSON format for drug components, treating as text: AZT (Zidov): NRTI, ?c ch? enzyme reverse transcriptase, ngăn virus HIV sao chép. 3TC (Lamiv): NRTI, k?t h?p v?i AZT đ? tăng cư?ng hi?u qu? đi?u tr?. EFV (Efavir): NNRTI, ?c ch? reverse transcriptase khác cơ ch? v?i NRTI.
2025-07-10 01:50:39 [http-nio-8080-exec-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 515, SQLState: 23000
2025-07-10 01:50:39 [http-nio-8080-exec-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Cannot insert the value NULL into column 'created_at', table 'hiv_medical.dbo.treatment_plan_templates'; column does not allow nulls. INSERT fails.
2025-07-10 01:51:07 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/templates
2025-07-10 01:51:07 [http-nio-8080-exec-2] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/templates with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MTUwNX0.XqaQrMqMWEE3wx_n29FsKDrdXnfVQzXqJzC0z15-LyY
2025-07-10 01:51:07 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MTUwNX0.XqaQrMqMWEE3wx_n29FsKDrdXnfVQzXqJzC0z15-LyY
2025-07-10 01:51:07 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 01:51:07 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 01:51:07 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 01:51:07 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 01:51:07 [http-nio-8080-exec-2] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/templates - username: tramtbse181958, role: DOCTOR
2025-07-10 01:51:07 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/treatment-plans/templates
2025-07-10 01:51:07 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/templates
2025-07-10 01:51:07 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/templates
2025-07-10 01:51:07 [http-nio-8080-exec-2] WARN  c.h.m.service.TreatmentPlanService - Invalid JSON format for drug components, treating as text: AZT (Zidov): NRTI, ?c ch? enzyme reverse transcriptase, ngăn virus HIV sao chép. 3TC (Lamiv): NRTI, k?t h?p v?i AZT đ? tăng cư?ng hi?u qu? đi?u tr?. EFV (Efavir): NNRTI, ?c ch? reverse transcriptase khác cơ ch? v?i NRTI.
2025-07-10 01:51:07 [http-nio-8080-exec-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 515, SQLState: 23000
2025-07-10 01:51:07 [http-nio-8080-exec-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Cannot insert the value NULL into column 'created_at', table 'hiv_medical.dbo.treatment_plan_templates'; column does not allow nulls. INSERT fails.
2025-07-10 01:53:01 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 01:53:01 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 01:53:01 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 01:53:01 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 01:53:01 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 01:53:04 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 13660 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 01:53:04 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 01:53:04 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 01:53:05 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 01:53:05 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 63 ms. Found 9 JPA repository interfaces.
2025-07-10 01:53:05 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 01:53:05 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 01:53:05 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 01:53:06 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 01:53:06 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1538 ms
2025-07-10 01:53:06 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 01:53:06 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 01:53:06 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 01:53:06 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 01:53:06 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 01:53:06 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 01:53:06 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 01:53:07 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: b8939144-108c-439c-9f14-b35989d67341
2025-07-10 01:53:07 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 01:53:07 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 01:53:07 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 01:53:08 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 01:53:09 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 01:53:09 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 01:53:10 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 01:53:10 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 01:53:10 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 01:53:10 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 01:53:11 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 01:53:11 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 01:53:11 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 01:53:11 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 7.783 seconds (process running for 8.502)
2025-07-10 01:53:19 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-10 01:53:19 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-10 01:53:19 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-07-10 01:53:19 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/templates
2025-07-10 01:53:19 [http-nio-8080-exec-1] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/templates with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MTUwNX0.XqaQrMqMWEE3wx_n29FsKDrdXnfVQzXqJzC0z15-LyY
2025-07-10 01:53:19 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MTUwNX0.XqaQrMqMWEE3wx_n29FsKDrdXnfVQzXqJzC0z15-LyY
2025-07-10 01:53:19 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 01:53:19 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 01:53:19 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 01:53:19 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 01:53:19 [http-nio-8080-exec-1] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/templates - username: tramtbse181958, role: DOCTOR
2025-07-10 01:53:19 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/treatment-plans/templates
2025-07-10 01:53:19 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/templates
2025-07-10 01:53:19 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/templates
2025-07-10 01:53:20 [http-nio-8080-exec-1] WARN  c.h.m.service.TreatmentPlanService - Invalid JSON format for drug components, treating as text: AZT (Zidov): NRTI, ?c ch? enzyme reverse transcriptase, ngăn virus HIV sao chép. 3TC (Lamiv): NRTI, k?t h?p v?i AZT đ? tăng cư?ng hi?u qu? đi?u tr?. EFV (Efavir): NNRTI, ?c ch? reverse transcriptase khác cơ ch? v?i NRTI.
2025-07-10 01:53:20 [http-nio-8080-exec-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 515, SQLState: 23000
2025-07-10 01:53:20 [http-nio-8080-exec-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Cannot insert the value NULL into column 'created_at', table 'hiv_medical.dbo.treatment_plan_templates'; column does not allow nulls. INSERT fails.
2025-07-10 01:58:27 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 01:58:27 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 01:58:27 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 01:58:27 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 01:58:27 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 01:58:33 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 18848 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 01:58:33 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 01:58:33 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 01:58:34 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 01:58:35 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 81 ms. Found 9 JPA repository interfaces.
2025-07-10 01:58:35 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 01:58:35 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 01:58:35 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 01:58:35 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 01:58:35 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2064 ms
2025-07-10 01:58:35 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 01:58:35 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 01:58:36 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 01:58:36 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 01:58:36 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 01:58:36 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 01:58:36 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 01:58:37 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: b34c5d91-9257-471c-aca0-c0f1f7ac9e99
2025-07-10 01:58:37 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 01:58:37 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 01:58:37 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 01:58:38 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 01:58:39 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 01:58:39 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 01:58:40 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 01:58:40 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 01:58:40 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 01:58:40 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 01:58:40 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 01:58:40 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 01:58:41 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 01:58:41 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 8.441 seconds (process running for 9.71)
2025-07-10 01:58:59 [http-nio-8080-exec-4] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-10 01:58:59 [http-nio-8080-exec-4] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-10 01:58:59 [http-nio-8080-exec-4] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-07-10 01:58:59 [http-nio-8080-exec-4] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/templates
2025-07-10 01:58:59 [http-nio-8080-exec-4] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/templates with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MTUwNX0.XqaQrMqMWEE3wx_n29FsKDrdXnfVQzXqJzC0z15-LyY
2025-07-10 01:58:59 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3MTUwNX0.XqaQrMqMWEE3wx_n29FsKDrdXnfVQzXqJzC0z15-LyY
2025-07-10 01:58:59 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 01:58:59 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 01:58:59 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 01:58:59 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 01:58:59 [http-nio-8080-exec-4] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/templates - username: tramtbse181958, role: DOCTOR
2025-07-10 01:58:59 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/treatment-plans/templates
2025-07-10 01:58:59 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/templates
2025-07-10 01:58:59 [http-nio-8080-exec-4] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/templates
2025-07-10 01:58:59 [http-nio-8080-exec-4] WARN  c.h.m.service.TreatmentPlanService - Invalid JSON format for drug components, treating as text: AZT (Zidov): NRTI, ?c ch? enzyme reverse transcriptase, ngăn virus HIV sao chép. 3TC (Lamiv): NRTI, k?t h?p v?i AZT đ? tăng cư?ng hi?u qu? đi?u tr?. EFV (Efavir): NNRTI, ?c ch? reverse transcriptase khác cơ ch? v?i NRTI.
2025-07-10 02:05:10 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/login
2025-07-10 02:05:10 [http-nio-8080-exec-6] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/auth/login with Authorization header: null
2025-07-10 02:05:10 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - No Bearer token found in request to /api/auth/login
2025-07-10 02:05:10 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/auth/login
2025-07-10 02:05:10 [http-nio-8080-exec-6] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-07-10 02:05:10 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/login
2025-07-10 02:05:10 [http-nio-8080-exec-6] INFO  c.h.medical.controller.AuthAPI - Processing login request for email: tramtbse181958@fpt.edu.vn
2025-07-10 02:05:10 [http-nio-8080-exec-6] INFO  c.h.medical.controller.AuthAPI - Generated JWT for user tramtbse181958: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:05:10 [http-nio-8080-exec-6] DEBUG c.h.medical.controller.AuthAPI - Token claims - username: tramtbse181958, role: DOCTOR, fullName: BS. Nguyễn Văn K, expiresAt: Fri Jul 11 02:05:10 GMT+07:00 2025
2025-07-10 02:05:59 [http-nio-8080-exec-5] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/patient-treatment-plans
2025-07-10 02:05:59 [http-nio-8080-exec-5] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/patient-treatment-plans with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:05:59 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:05:59 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 02:05:59 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 02:05:59 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 02:05:59 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 02:05:59 [http-nio-8080-exec-5] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/patient-treatment-plans - username: tramtbse181958, role: DOCTOR
2025-07-10 02:05:59 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/patient-treatment-plans
2025-07-10 02:05:59 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/patient-treatment-plans
2025-07-10 02:05:59 [http-nio-8080-exec-5] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/patient-treatment-plans
2025-07-10 02:11:38 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 02:11:38 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 02:11:38 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 02:11:38 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 02:11:38 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 02:24:46 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 9020 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 02:24:46 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 02:24:46 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 02:24:48 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 02:24:48 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 103 ms. Found 9 JPA repository interfaces.
2025-07-10 02:24:49 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 02:24:49 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 02:24:49 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 02:24:49 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 02:24:49 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2440 ms
2025-07-10 02:24:49 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 02:24:49 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 02:24:49 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 02:24:49 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 02:24:49 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 02:24:50 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 02:24:50 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 02:24:50 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 69d03ff6-ba0f-4474-9275-fe329396271e
2025-07-10 02:24:50 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 02:24:50 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 02:24:50 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 02:24:51 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 02:24:52 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 02:24:53 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 02:24:54 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 02:24:54 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 02:24:54 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 02:24:54 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 02:24:54 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 02:24:54 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 02:24:54 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 02:24:54 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 9.144 seconds (process running for 10.477)
2025-07-10 02:24:59 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-10 02:24:59 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-10 02:24:59 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-07-10 02:24:59 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/patient-treatment-plans
2025-07-10 02:24:59 [http-nio-8080-exec-1] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/patient-treatment-plans with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:24:59 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:24:59 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 02:24:59 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 02:24:59 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 02:24:59 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 02:24:59 [http-nio-8080-exec-1] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/patient-treatment-plans - username: tramtbse181958, role: DOCTOR
2025-07-10 02:24:59 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/patient-treatment-plans
2025-07-10 02:24:59 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/patient-treatment-plans
2025-07-10 02:24:59 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/patient-treatment-plans
2025-07-10 02:25:35 [http-nio-8080-exec-5] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/patient-treatment-plans
2025-07-10 02:25:35 [http-nio-8080-exec-5] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/patient-treatment-plans with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:25:35 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:25:35 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 02:25:35 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 02:25:35 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 02:25:35 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 02:25:35 [http-nio-8080-exec-5] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/patient-treatment-plans - username: tramtbse181958, role: DOCTOR
2025-07-10 02:25:35 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/patient-treatment-plans
2025-07-10 02:25:35 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/patient-treatment-plans
2025-07-10 02:25:35 [http-nio-8080-exec-5] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/patient-treatment-plans
2025-07-10 02:26:48 [http-nio-8080-exec-7] DEBUG o.s.s.w.f.HttpStatusRequestRejectedHandler - Rejecting request due to: The request was rejected because the URL contained a potentially malicious String "//"
org.springframework.security.web.firewall.RequestRejectedException: The request was rejected because the URL contained a potentially malicious String "//"
	at org.springframework.security.web.firewall.StrictHttpFirewall.rejectedBlocklistedUrls(StrictHttpFirewall.java:548)
	at org.springframework.security.web.firewall.StrictHttpFirewall.getFirewalledRequest(StrictHttpFirewall.java:518)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:211)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.ServletRequestPathFilter.doFilter(ServletRequestPathFilter.java:52)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebSecurityConfiguration.java:319)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$4(HandlerMappingIntrospector.java:267)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:240)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1447)
2025-07-10 02:26:48 [http-nio-8080-exec-7] DEBUG o.s.security.web.FilterChainProxy - Securing POST /error
2025-07-10 02:26:48 [http-nio-8080-exec-7] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-07-10 02:26:48 [http-nio-8080-exec-7] DEBUG o.s.security.web.FilterChainProxy - Secured POST /error
2025-07-10 02:27:15 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:27:15 [http-nio-8080-exec-6] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/patient-treatment-plans with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:27:15 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:27:15 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 02:27:15 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 02:27:15 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 02:27:15 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 02:27:15 [http-nio-8080-exec-6] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/patient-treatment-plans - username: tramtbse181958, role: DOCTOR
2025-07-10 02:27:15 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:27:15 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:27:15 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:28:21 [http-nio-8080-exec-10] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:28:21 [http-nio-8080-exec-10] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/patient-treatment-plans with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:28:21 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:28:21 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 02:28:21 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 02:28:21 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 02:28:21 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 02:28:21 [http-nio-8080-exec-10] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/patient-treatment-plans - username: tramtbse181958, role: DOCTOR
2025-07-10 02:28:21 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:28:21 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:28:21 [http-nio-8080-exec-10] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:28:34 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:28:34 [http-nio-8080-exec-1] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/patient-treatment-plans with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:28:34 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:28:34 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 02:28:34 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 02:28:34 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 02:28:34 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 02:28:34 [http-nio-8080-exec-1] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/patient-treatment-plans - username: tramtbse181958, role: DOCTOR
2025-07-10 02:28:34 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:28:34 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:28:34 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:31:51 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 02:31:51 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 02:31:51 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 02:31:51 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 02:31:51 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 02:31:57 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 144 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 02:31:57 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 02:31:57 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 02:31:58 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 02:31:58 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 77 ms. Found 9 JPA repository interfaces.
2025-07-10 02:31:59 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 02:31:59 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 02:31:59 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 02:31:59 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 02:31:59 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2091 ms
2025-07-10 02:31:59 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 02:31:59 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 02:31:59 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 02:31:59 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 02:31:59 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 02:31:59 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 02:31:59 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 02:32:00 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 54c1f994-3fb2-47d6-99ab-d6e156d5e348
2025-07-10 02:32:00 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 02:32:00 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 02:32:00 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 02:32:01 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 02:32:02 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 02:32:02 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 02:32:04 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 02:32:04 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 02:32:04 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 02:32:04 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 02:32:04 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 02:32:04 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 02:32:05 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 02:32:05 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 9.381 seconds (process running for 10.641)
2025-07-10 02:32:12 [http-nio-8080-exec-5] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-10 02:32:12 [http-nio-8080-exec-5] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-10 02:32:12 [http-nio-8080-exec-5] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-07-10 02:32:12 [http-nio-8080-exec-5] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:32:12 [http-nio-8080-exec-5] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/patient-treatment-plans with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:32:12 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:32:12 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 02:32:12 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 02:32:12 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 02:32:12 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 02:32:12 [http-nio-8080-exec-5] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/patient-treatment-plans - username: tramtbse181958, role: DOCTOR
2025-07-10 02:32:12 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:32:12 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:32:12 [http-nio-8080-exec-5] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:32:12 [http-nio-8080-exec-5] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 2627, SQLState: 23000
2025-07-10 02:32:12 [http-nio-8080-exec-5] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Violation of PRIMARY KEY constraint 'PK__patient___C342919934A20B5C'. Cannot insert duplicate key in object 'dbo.patient_treatment_plans'. The duplicate key value is (5, 9).
2025-07-10 02:35:36 [http-nio-8080-exec-4] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:35:36 [http-nio-8080-exec-4] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/patient-treatment-plans with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:35:36 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:35:36 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 02:35:36 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 02:35:36 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 02:35:36 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 02:35:36 [http-nio-8080-exec-4] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/patient-treatment-plans - username: tramtbse181958, role: DOCTOR
2025-07-10 02:35:36 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:35:36 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:35:36 [http-nio-8080-exec-4] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:35:36 [http-nio-8080-exec-4] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 2627, SQLState: 23000
2025-07-10 02:35:36 [http-nio-8080-exec-4] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Violation of PRIMARY KEY constraint 'PK__patient___C342919934A20B5C'. Cannot insert duplicate key in object 'dbo.patient_treatment_plans'. The duplicate key value is (5, 9).
2025-07-10 02:38:46 [http-nio-8080-exec-3] DEBUG o.s.security.web.FilterChainProxy - Securing OPTIONS /api/auth/register
2025-07-10 02:38:46 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/register
2025-07-10 02:38:46 [http-nio-8080-exec-6] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/auth/register with Authorization header: null
2025-07-10 02:38:46 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - No Bearer token found in request to /api/auth/register
2025-07-10 02:38:46 [http-nio-8080-exec-6] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/auth/register
2025-07-10 02:38:46 [http-nio-8080-exec-6] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-07-10 02:38:46 [http-nio-8080-exec-6] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/register
2025-07-10 02:38:46 [http-nio-8080-exec-6] INFO  c.h.medical.controller.AuthAPI - Processing registration request for email: se181958trinhbichtram@gmail.com
2025-07-10 02:38:46 [http-nio-8080-exec-6] INFO  c.h.medical.service.EmailService - Attempting to send OTP email to: se181958trinhbichtram@gmail.com
2025-07-10 02:38:50 [http-nio-8080-exec-6] INFO  c.h.medical.service.EmailService - OTP email sent successfully to: se181958trinhbichtram@gmail.com
2025-07-10 02:39:20 [http-nio-8080-exec-7] DEBUG o.s.security.web.FilterChainProxy - Securing OPTIONS /api/auth/register-verify-otp
2025-07-10 02:39:20 [http-nio-8080-exec-8] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/register-verify-otp
2025-07-10 02:39:20 [http-nio-8080-exec-8] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/auth/register-verify-otp with Authorization header: null
2025-07-10 02:39:20 [http-nio-8080-exec-8] DEBUG c.h.m.s.JwtAuthenticationFilter - No Bearer token found in request to /api/auth/register-verify-otp
2025-07-10 02:39:20 [http-nio-8080-exec-8] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/auth/register-verify-otp
2025-07-10 02:39:20 [http-nio-8080-exec-8] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-07-10 02:39:20 [http-nio-8080-exec-8] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/register-verify-otp
2025-07-10 02:39:20 [http-nio-8080-exec-8] INFO  c.h.medical.controller.AuthAPI - Verifying OTP for email: se181958trinhbichtram@gmail.com
2025-07-10 02:39:40 [http-nio-8080-exec-10] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:39:40 [http-nio-8080-exec-10] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/patient-treatment-plans with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:39:40 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3NDMxMH0.DMu2TIKb_SCj9G2z-354r_epcrciFb1P8TMVTHTAcKk
2025-07-10 02:39:40 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 02:39:40 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 02:39:40 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 02:39:40 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 02:39:40 [http-nio-8080-exec-10] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/patient-treatment-plans - username: tramtbse181958, role: DOCTOR
2025-07-10 02:39:40 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:39:40 [http-nio-8080-exec-10] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:39:40 [http-nio-8080-exec-10] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:46:15 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 02:46:15 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 02:46:15 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 02:46:15 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 02:46:15 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 02:49:07 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 23900 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 02:49:07 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 02:49:07 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 02:49:09 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 02:49:09 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 124 ms. Found 9 JPA repository interfaces.
2025-07-10 02:49:10 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 02:49:10 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 3100 ms
2025-07-10 02:49:10 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 02:49:10 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 02:49:11 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 02:49:11 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 02:49:11 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 02:49:11 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 02:49:11 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 02:49:11 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: 34326bef-9d92-4604-8feb-3e30758ce241
2025-07-10 02:49:11 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 02:49:12 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 02:49:12 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 02:49:13 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 02:49:15 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 02:49:16 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 02:49:18 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 02:49:18 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 02:49:19 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 02:49:19 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 02:49:19 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 02:49:19 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 02:49:19 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 02:49:19 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 13.302 seconds (process running for 14.51)
2025-07-10 02:49:19 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 02:49:19 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 02:49:19 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 02:49:19 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 02:49:19 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-07-10 02:49:31 [main] INFO  c.h.medical.MedicalApplication - Starting MedicalApplication using Java 24.0.1 with PID 20600 (D:\CN5\FER202\BE_HIV\hiv-treatment-backend\target\classes started by tram2 in D:\CN5\FER202\BE_HIV\hiv-treatment-backend)
2025-07-10 02:49:31 [main] DEBUG c.h.medical.MedicalApplication - Running with Spring Boot v3.5.4-SNAPSHOT, Spring v6.2.9-SNAPSHOT
2025-07-10 02:49:31 [main] INFO  c.h.medical.MedicalApplication - No active profile set, falling back to 1 default profile: "default"
2025-07-10 02:49:32 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-10 02:49:32 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 120 ms. Found 9 JPA repository interfaces.
2025-07-10 02:49:33 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-07-10 02:49:33 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-07-10 02:49:33 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.42]
2025-07-10 02:49:33 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-07-10 02:49:33 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2433 ms
2025-07-10 02:49:33 [main] INFO  c.h.m.s.JwtAuthenticationFilter - JwtAuthenticationFilter initialized with secret: 1234567890
2025-07-10 02:49:33 [main] DEBUG c.h.m.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-07-10 02:49:34 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-10 02:49:34 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.18.Final
2025-07-10 02:49:34 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-07-10 02:49:34 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-10 02:49:34 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-07-10 02:49:35 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection ConnectionID:1 ClientConnectionId: a31c8e63-5e9e-4cda-97ba-c787f79668eb
2025-07-10 02:49:35 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-07-10 02:49:35 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: SQLServerDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-10 02:49:35 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 15.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-07-10 02:49:36 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-07-10 02:49:37 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 02:49:38 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-10 02:49:39 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-10 02:49:39 [main] DEBUG o.s.s.c.a.a.c.AuthenticationConfiguration$DefaultPasswordEncoderAuthenticationManagerBuilder - No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-07-10 02:49:39 [main] INFO  c.h.medical.config.SecurityConfig - Configuring SecurityFilterChain with rules
2025-07-10 02:49:39 [main] INFO  c.h.medical.config.SecurityConfig - Setting up authorization rules
2025-07-10 02:49:40 [main] DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-07-10 02:49:40 [main] INFO  c.h.medical.config.SecurityConfig - Initializing AuthenticationManager
2025-07-10 02:49:41 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-07-10 02:49:41 [main] INFO  c.h.medical.MedicalApplication - Started MedicalApplication in 11.513 seconds (process running for 12.992)
2025-07-10 02:51:44 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-10 02:51:44 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-07-10 02:51:44 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-07-10 02:51:44 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/login
2025-07-10 02:51:44 [http-nio-8080-exec-2] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/auth/login with Authorization header: null
2025-07-10 02:51:44 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - No Bearer token found in request to /api/auth/login
2025-07-10 02:51:44 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/auth/login
2025-07-10 02:51:44 [http-nio-8080-exec-2] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-07-10 02:51:44 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/login
2025-07-10 02:51:45 [http-nio-8080-exec-2] INFO  c.h.medical.controller.AuthAPI - Processing login request for email: doctor@example.com
2025-07-10 02:51:45 [http-nio-8080-exec-2] INFO  c.h.medical.controller.AuthAPI - Generated JWT for user doctor: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRvY3RvciIsInJvbGUiOiJET0NUT1IiLCJmdWxsTmFtZSI6ImRvY3RvciIsImV4cCI6MTc1MjE3NzEwNX0.rob_Oy1ro5JkvKDV9i7591hzaPKEeQWOpCRjOMza0MU
2025-07-10 02:51:45 [http-nio-8080-exec-2] DEBUG c.h.medical.controller.AuthAPI - Token claims - username: doctor, role: DOCTOR, fullName: null, expiresAt: Fri Jul 11 02:51:45 GMT+07:00 2025
2025-07-10 02:52:14 [http-nio-8080-exec-4] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:52:14 [http-nio-8080-exec-4] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/patient-treatment-plans with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRvY3RvciIsInJvbGUiOiJET0NUT1IiLCJmdWxsTmFtZSI6ImRvY3RvciIsImV4cCI6MTc1MjE3NzEwNX0.rob_Oy1ro5JkvKDV9i7591hzaPKEeQWOpCRjOMza0MU
2025-07-10 02:52:14 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRvY3RvciIsInJvbGUiOiJET0NUT1IiLCJmdWxsTmFtZSI6ImRvY3RvciIsImV4cCI6MTc1MjE3NzEwNX0.rob_Oy1ro5JkvKDV9i7591hzaPKEeQWOpCRjOMza0MU
2025-07-10 02:52:14 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 02:52:14 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 02:52:14 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 02:52:14 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: doctor, role: DOCTOR
2025-07-10 02:52:14 [http-nio-8080-exec-4] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/patient-treatment-plans - username: doctor, role: DOCTOR
2025-07-10 02:52:14 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: doctor with role: DOCTOR for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:52:14 [http-nio-8080-exec-4] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:52:14 [http-nio-8080-exec-4] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:52:30 [http-nio-8080-exec-3] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:52:30 [http-nio-8080-exec-3] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/patient-treatment-plans with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRvY3RvciIsInJvbGUiOiJET0NUT1IiLCJmdWxsTmFtZSI6ImRvY3RvciIsImV4cCI6MTc1MjE3NzEwNX0.rob_Oy1ro5JkvKDV9i7591hzaPKEeQWOpCRjOMza0MU
2025-07-10 02:52:30 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRvY3RvciIsInJvbGUiOiJET0NUT1IiLCJmdWxsTmFtZSI6ImRvY3RvciIsImV4cCI6MTc1MjE3NzEwNX0.rob_Oy1ro5JkvKDV9i7591hzaPKEeQWOpCRjOMza0MU
2025-07-10 02:52:30 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 02:52:30 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 02:52:30 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 02:52:30 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: doctor, role: DOCTOR
2025-07-10 02:52:30 [http-nio-8080-exec-3] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/patient-treatment-plans - username: doctor, role: DOCTOR
2025-07-10 02:52:30 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: doctor with role: DOCTOR for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:52:30 [http-nio-8080-exec-3] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:52:30 [http-nio-8080-exec-3] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:52:39 [http-nio-8080-exec-7] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:52:39 [http-nio-8080-exec-7] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/patient-treatment-plans with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRvY3RvciIsInJvbGUiOiJET0NUT1IiLCJmdWxsTmFtZSI6ImRvY3RvciIsImV4cCI6MTc1MjE3NzEwNX0.rob_Oy1ro5JkvKDV9i7591hzaPKEeQWOpCRjOMza0MU
2025-07-10 02:52:39 [http-nio-8080-exec-7] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRvY3RvciIsInJvbGUiOiJET0NUT1IiLCJmdWxsTmFtZSI6ImRvY3RvciIsImV4cCI6MTc1MjE3NzEwNX0.rob_Oy1ro5JkvKDV9i7591hzaPKEeQWOpCRjOMza0MU
2025-07-10 02:52:39 [http-nio-8080-exec-7] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 02:52:39 [http-nio-8080-exec-7] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 02:52:39 [http-nio-8080-exec-7] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 02:52:39 [http-nio-8080-exec-7] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: doctor, role: DOCTOR
2025-07-10 02:52:39 [http-nio-8080-exec-7] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/patient-treatment-plans - username: doctor, role: DOCTOR
2025-07-10 02:52:39 [http-nio-8080-exec-7] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: doctor with role: DOCTOR for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:52:39 [http-nio-8080-exec-7] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:52:39 [http-nio-8080-exec-7] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:57:42 [http-nio-8080-exec-9] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:57:42 [http-nio-8080-exec-9] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/patient-treatment-plans with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRvY3RvciIsInJvbGUiOiJET0NUT1IiLCJmdWxsTmFtZSI6ImRvY3RvciIsImV4cCI6MTc1MjE3NzEwNX0.rob_Oy1ro5JkvKDV9i7591hzaPKEeQWOpCRjOMza0MU
2025-07-10 02:57:42 [http-nio-8080-exec-9] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRvY3RvciIsInJvbGUiOiJET0NUT1IiLCJmdWxsTmFtZSI6ImRvY3RvciIsImV4cCI6MTc1MjE3NzEwNX0.rob_Oy1ro5JkvKDV9i7591hzaPKEeQWOpCRjOMza0MU
2025-07-10 02:57:42 [http-nio-8080-exec-9] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 02:57:42 [http-nio-8080-exec-9] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 02:57:42 [http-nio-8080-exec-9] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 02:57:42 [http-nio-8080-exec-9] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: doctor, role: DOCTOR
2025-07-10 02:57:42 [http-nio-8080-exec-9] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/patient-treatment-plans - username: doctor, role: DOCTOR
2025-07-10 02:57:42 [http-nio-8080-exec-9] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: doctor with role: DOCTOR for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:57:42 [http-nio-8080-exec-9] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:57:42 [http-nio-8080-exec-9] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:57:52 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:57:52 [http-nio-8080-exec-1] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/patient-treatment-plans with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRvY3RvciIsInJvbGUiOiJET0NUT1IiLCJmdWxsTmFtZSI6ImRvY3RvciIsImV4cCI6MTc1MjE3NzEwNX0.rob_Oy1ro5JkvKDV9i7591hzaPKEeQWOpCRjOMza0MU
2025-07-10 02:57:52 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImRvY3RvciIsInJvbGUiOiJET0NUT1IiLCJmdWxsTmFtZSI6ImRvY3RvciIsImV4cCI6MTc1MjE3NzEwNX0.rob_Oy1ro5JkvKDV9i7591hzaPKEeQWOpCRjOMza0MU
2025-07-10 02:57:52 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 02:57:52 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 02:57:52 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 02:57:52 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: doctor, role: DOCTOR
2025-07-10 02:57:52 [http-nio-8080-exec-1] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/patient-treatment-plans - username: doctor, role: DOCTOR
2025-07-10 02:57:52 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: doctor with role: DOCTOR for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:57:52 [http-nio-8080-exec-1] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 02:57:52 [http-nio-8080-exec-1] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 03:02:30 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/auth/login
2025-07-10 03:02:30 [http-nio-8080-exec-2] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/auth/login with Authorization header: null
2025-07-10 03:02:30 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - No Bearer token found in request to /api/auth/login
2025-07-10 03:02:30 [http-nio-8080-exec-2] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/auth/login
2025-07-10 03:02:30 [http-nio-8080-exec-2] DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-07-10 03:02:30 [http-nio-8080-exec-2] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/auth/login
2025-07-10 03:02:30 [http-nio-8080-exec-2] INFO  c.h.medical.controller.AuthAPI - Processing login request for email: tramtbse181958@fpt.edu.vn
2025-07-10 03:02:30 [http-nio-8080-exec-2] INFO  c.h.medical.controller.AuthAPI - Generated JWT for user tramtbse181958: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3Nzc1MH0.o_B-y9u8gv1SSaonORAp5J7qQadLENu3HbfElrj9dAQ
2025-07-10 03:02:30 [http-nio-8080-exec-2] DEBUG c.h.medical.controller.AuthAPI - Token claims - username: tramtbse181958, role: DOCTOR, fullName: BS. Nguyễn Văn K, expiresAt: Fri Jul 11 03:02:30 GMT+07:00 2025
2025-07-10 03:02:52 [http-nio-8080-exec-5] DEBUG o.s.security.web.FilterChainProxy - Securing POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 03:02:52 [http-nio-8080-exec-5] INFO  c.h.m.s.JwtAuthenticationFilter - Processing request to /api/doctor/treatment-plans/patient-treatment-plans with Authorization header: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3Nzc1MH0.o_B-y9u8gv1SSaonORAp5J7qQadLENu3HbfElrj9dAQ
2025-07-10 03:02:52 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Verifying JWT token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRyYW10YnNlMTgxOTU4Iiwicm9sZSI6IkRPQ1RPUiIsImZ1bGxOYW1lIjoiQlMuIE5ndXnhu4VuIFbEg24gSyIsImV4cCI6MTc1MjE3Nzc1MH0.o_B-y9u8gv1SSaonORAp5J7qQadLENu3HbfElrj9dAQ
2025-07-10 03:02:52 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Using secret key: 1234567890
2025-07-10 03:02:52 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - JWT verifier initialized
2025-07-10 03:02:52 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Token verification completed
2025-07-10 03:02:52 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Extracted claims - username: tramtbse181958, role: DOCTOR
2025-07-10 03:02:52 [http-nio-8080-exec-5] INFO  c.h.m.s.JwtAuthenticationFilter - Token verified for request to /api/doctor/treatment-plans/patient-treatment-plans - username: tramtbse181958, role: DOCTOR
2025-07-10 03:02:52 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Authentication set for user: tramtbse181958 with role: DOCTOR for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 03:02:52 [http-nio-8080-exec-5] DEBUG c.h.m.s.JwtAuthenticationFilter - Proceeding to next filter for request to /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 03:02:52 [http-nio-8080-exec-5] DEBUG o.s.security.web.FilterChainProxy - Secured POST /api/doctor/treatment-plans/patient-treatment-plans
2025-07-10 03:04:28 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-07-10 03:04:28 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-07-10 03:04:28 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-07-10 03:04:28 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-07-10 03:04:28 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
